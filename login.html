<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="node_modules/bulma/css/bulma.css" />
        <link rel="stylesheet" href="custom_style.css"/>
        <link href="https://fonts.googleapis.com/css?family=Shrikhand&display=swap" rel="stylesheet">
        <title>Mapper | Login</title>
    </head>
<body>
        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <script src="node_modules/axios/dist/axios.min.js"></script>
        <script src="https://kit.fontawesome.com/3e308f3171.js" crossorigin="anonymous"></script>

        <main>
        <div id="root">
            <div class="pageHeader" id="fixedHeader">
                <a href="./index.html" class="titleLogo title">Mapper&nbsp&nbsp<i class="fas fa-route"></i></a>
                    <div class="header-right">
                        <a href="./login.html" id="login" class="button top is-rounded">Login</a>
                        <a href="./user.html" id="mytrips" class="button top is-rounded">My Trips</a>
                    </div>
            </div>
            <div class="content" style="min-height: 1000px; margin-top: 50px;">
                <div style="text-align: center;">
                    <span style="font-size: 40px; color: black;"><b>Login</b></span>
                    <form><br>
                        <label style="color: black;" for="username">Username</label><br>
                        <input class="input is-small is-rounded" style="width: 250px;" type="text" id="username" name="username">
                        <br><br>
                        <label style="color: black;" for="password">Password</label><br>
                        <input class="input is-small is-rounded" style="width: 250px;" type="password" id="password" name="password">
                    </form>
                    <br>
                    <button class="button is-rounded" style="width: 100px;" id="loginButton">Login</button>
                    <br>
                    <br>
                    <span style="color: black;">Don't have an account yet?</span><br>
                    <a href="./newUser.html"><u>Get started here.</u></a>
                </div>
            </div>
        </div>
        <script>
            async function LoginButtonHandler(event){
            event.preventDefault();
            try {
                let result= await axios.post('https://mapper-project.herokuapp.com/login', { user: $('#username').val(),
                password: $('#password').val() }, { headers: {'Access-Control-Allow-Origin': '*'}});
                console.log("result of login")
                console.log(result);
                document.cookie = "username=" + $('#username').val();
                console.log("Logged in and set cookie")
                window.location.replace("https://mapper-project.herokuapp.com/index.html");
            } catch {
                window.alert("Username and password not found!")
            }
            }

            $('main').on('click', '#loginButton', LoginButtonHandler);
        </script>
        <script src="./cookieButtonFunction.js"></script>
        </main>
</body>
</html>